# AI 心象签项目变更记录

## 2025-10-05 · 挂件字体加载专项
- `charm-font-loader` 支持优先全局字体缓存，不支持 `global` 的端再按页面作用域补齐，首页与详情页翻面字体同步生效。
- `App` 启动阶段预载书法字体并缓存 Promise，组件侧仅保留兜底重试，真机首屏不再闪回系统字体。
- 延续字体资源缓存与失败降级策略，确保字体下载、读取异常时安全回退系统字体。

## 2025-09-30 · 签体推荐算法系统
- 构建 10 维签体特征矩阵与 Redis 曝光追踪，覆盖 18 种传统挂件，实现曝光均衡与历史去重。
- `TwoStageGenerator` 引入加权余弦相似度、随机扰动与曝光加成的多维评分机制，候选池扩展至 Top-5，并可通过环境变量灰度控制。

## 2025-09-30 · 心境速测题库优化
- 重新整理 90 道题库，按情绪与场景分组，首屏精选 25 题并动态抽取 5 题，题目体验更聚焦。
- 新增作答记录与题目曝光监控，控制高频题目重复出现。

## 2025-09-10 · 小程序前端增强
- 首页挂件组件升级 3D 翻面与竖排书法布局，详情页沿用统一组件体系保持体验一致。
- 引入资源缓存、异常兜底与鉴权增强，保障弱网与授权异常下的稳定性。

## 2025-09-01 · 基础设施与工作流
- 完成 Gateway + User/Postcard/AI-Agent 微服务拆分，统一接入 PostgreSQL、Redis 与 Docker Compose。
- 两段式 AI 工作流上线（心理分析 → 内容生成 → 图像渲染），并配套安全审计、JWT/RBAC 认证体系。

---

**最后更新**: 2025-10-05
**项目状态**: 生产就绪 ✅（挂件书法字体已按需加载，核心工作流稳定运行）
